<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
    <head>
        <title>LiquiBase: Command Line Migrator</title>
        <style type='text/css' media='screen'>@import "../../include/css/main.css";</style>
    </head>
    <body>@ANALYTICS@
        <img src="../../images/liquibase_logo.gif" alt="LiquiBase" class="topLogo"/>
        <p id="sitename">
            <strong>LiquiBase: Database Refactoring</strong>
        </p>

        <div id="container">
                @NAV.MANUAL@


            <div id="content">
                <div class="entry">
                    <h2>Command Line Migrator</h2>
                    <p>
                        LiquiBase can be run from the command line by running<br/>
                        <strong>liquibase [options] [command]</strong> (optionally, replace the liquibase command with java -jar &lt;path-to-liquibase-jar>). 
                        The command line migrator works well when you want to do migrations on demand, but don't
                        have Ant or Maven available such as on servers.  The command line migrator also gives you more control
                        over the process than the <a href="ant.html">Ant</a>, <a href="maven.html">Maven</a>, or
                        <a href="servlet_listener_migrator.html">Servlet</a> migrators do, allowing you to run maintenance commands like outputting SQL and
                        listing/releasing database changelog locks.
                    </p>
                    <p>
                        The command line migrator also allows you to
                    </p>
                        <ul>
                            <li><a href="rollback.html">perform rollback operations and generate rollback scripts</a></li>
                            <li><a href="diff.html">generate "diff"s</a></li>
                            <li><a href="generate_changelog.html">generate creation scripts from existing databases</a></li>
                            <li><a href="dbdoc.html">generate database change documentation</a></li>
                        </ul>
                    <p>
                        If you run the command line migrator without any arguments, you will get a help message listing
                        these available parameters:
                    </p>
                    <h3>Standard Commands</h3>
                    <table class="attributesTable">
                        <tr><th>migrate</th><td>Updates database to current version</td></tr>
                        <tr><th>migrateSQL</th><td>Writes SQL to update database to current version to STDOUT</td></tr>
                        <tr><th>rollback &lt;tag&gt;</th><td>Rolls back the database to the the state is was when the tag was applied</td></tr>
                        <tr><th>rollbackToDate &lt;date/time&gt;</th><td>Rolls back the database to the the state is was at the given date/time</td></tr>
                        <tr><th>rollbackCount &lt;value&gt;</th><td>Rolls back the last &lt;value&gt; change sets</td></tr>
                        <tr><th>rollbackSQL &lt;tag&gt;</th><td>Writes SQL to roll back the database to that state it was in at when the tag was applied to STDOUT</td></tr>
                        <tr><th>rollbackToDateSQL &lt;date/time&gt;</th><td>Writes SQL to roll back the database to that state it was in at the given date/time version to STDOUT</td></tr>
                        <tr><th>rollbackCountSQL &lt;value&gt;</th><td>Writes SQL to roll back the last &lt;value&gt; change sets to STDOUT</td></tr>
                        <tr><th>futureRollbackSQL</th><td>Writes SQL to roll back the database to the current state after the changes in the changeslog have been applied</td></tr>
                        <tr><th>generateChangeLog</th><td>generateChangeLog of the database to standard out</td></tr>
                    </table>
                    <h3>Diff Commands</h3>
                    <table class="attributesTable">
                        <tr><th>diff [diff parameters]</th><td>Writes description of differences to standard out</td></tr>
                        <tr><th>diffChangeLog [diff parameters]</th><td>Writes Change Log XML to update the base database to the target database to standard out</td></tr>
                    </table>
                    <h3>Documentation Commands</h3>
                    <table class="attributesTable">
                        <tr><th>dbDoc &lt;outputDirectory&gt;</th><td>Generates Javadoc-like documentation based on current database and change log</td></tr>
                    </table>
                    <h3>Maintenance Commands</h3>
                    <table class="attributesTable">
                        <tr><th>tag</th><td>'Tags' the current database state for future rollback</td></tr>
                        <tr><th>status</th><td>Outputs count (list if --verbose) of unrun change sets</td></tr>
                        <tr><th>validate</th><td>Checks the changelog for errors</td></tr>
                        <tr><th>changelogSyncSQL</th><td>Writes SQL to mark all changes as executed in the database to STDOUT</td></tr>
                        <tr><th>listLocks</th><td>Lists who currently has locks on the database changelog</td></tr>
                        <tr><th>releaseLocks</th><td>Releases all locks on the database changelog</td></tr>
                        <tr><th>dropAll</th><td>Drops all database objects owned by the user</td></tr>
                    </table>
                    <h3>Required Parameters</h3>
                    <table class="attributesTable">
                        <tr><th>--changeLogFile=&lt;path and filename&gt;</th><td>The changelog file to use</td></tr>
                        <tr><th>--username=&lt;value&gt;</th><td>Database username</td></tr>
                        <tr><th>--password=&lt;value></th><td>Database password</td></tr>
                        <tr><th>--url=&lt;value&gt;</th><td>Database URL</td></tr>
                        <tr><th>--driver=&lt;jdbc.driver.ClassName&gt;</th><td>Database driver class name</td></tr>
                    </table>
                    <h3>Optional Parameters</h3>
                    <table class="attributesTable">
                        <tr><th>--classpath=&lt;value&gt;</th><td>Classpath containing migration files and JDBC Driver.</td></tr>
                        <tr><th>--contexts=&lt;value&gt;</th><td>ChangeSet contexts to execute</td></tr>
                        <tr><th>--defaultsFile=&lt;/path/to/file&gt;</th><td>File containing default option values (default: ./liquibase.properties)</td></tr>
                        <tr><th>--includeSystemClasspath=&lt;true|false&gt;</th><td>Include the system classpath in the LiquiBase classpath (default: true)</td></tr>
                        <tr><th>--promptForNonLocalDatabase=&lt;true|false&gt;</th><td>Prompt if non-localhost databases (default: false)</td></tr>
                        <tr><th>--currentDateTimeFunction=&lt;value&gt;</th><td>Overrides current date time function used in SQL.  Useful for unsupported databases</td></tr>
                        <tr><th>--logLevel=&lt;level&gt;</th><td>Execution log level (finest, finer, fine, info, warning, severe)</td></tr>
                        <tr><th>--help=&lt;level&gt;</th><td>Execution log level (finest, finer, fine, info, warning, severe)</td></tr>
                    </table>

                    <h3>Required Diff Parameters</h3>
                    <table class="attributesTable">
                         <tr><th>--baseUsername=&lt;value&gt;</th><td>Base Database username</td></tr>
                         <tr><th>--basePassword=&lt;value&gt;</th><td>Base Database password</td></tr>
                         <tr><th>--baseUrl=&lt;value&gt;</th><td>Base Database URL</td></tr>
                    </table>
                    <h3>Optional Diff Parameters</h3>
                    <table class="attributesTable">
                        <tr><th>--baseDriver=&lt;jdbc.driver.ClassName&gt;</th><td>Base Database driver class name</td></tr>
                    </table>

                    <h2>Using a liquibase.properties file</h2>
                    <p>
                        If you do not want to always specify options on the command line, you can create a properties file
                        that contains default values.  By default, LiquiBase will look for a file called "liquibase.properties"
                        in the current working directory, but you can specify an alternate location with the --defaultsFile flag.
                        If you have specify an option in a properties file and specify the same option on the command line, the
                        value on the command line will override the properties file value.
                    </p>
                    <h2>Examples</h2>
                    <h3>Standard Migrator Run</h3>
                    <pre>java -jar liquibase.jar \
      --driver=oracle.jdbc.OracleDriver \
      --classpath=\path\to\classes:jdbcdriver.jar \
      --changeLogFile=com/example/db.changelog.xml \
      --url="jdbc:oracle:thin:@localhost:1521:oracle" \
      --username=scott \
      --password=tiger \
      migrate</pre>
                    <h3>
                        Run Migrator pulling changelogs from a .WAR file
                    </h3>
                    <pre>java -jar liquibase.jar \
      --driver=oracle.jdbc.OracleDriver \
      --classpath=website.war \
      --changeLogFile=com/example/db.changelog.xml \
      --url=jdbc:oracle:thin:@localhost:1521:oracle \
      --username=scott \
      --password=tiger \
      migrate</pre>
                    <h3>
                        Run Migrator pulling changelogs from an .EAR file
                    </h3>
                    <pre>java -jar liquibase.jar \
      --driver=oracle.jdbc.OracleDriver \
      --classpath=application.ear \
      --changeLogFile=com/example/db.changelog.xml \
      --url=jdbc:oracle:thin:@localhost:1521:oracle \
      --username=scott \
      --password=tiger</pre>
                    <h3>
                        Don't execute changesets, save SQL to /tmp/migrate.sql
                    </h3>
                    <pre>java -jar liquibase.jar \
        --driver=oracle.jdbc.OracleDriver \
        --classpath=jdbcdriver.jar \
        --url=jdbc:oracle:thin:@localhost:1521:oracle \
        --username=scott \
        --password=tiger \
        listLocks > /tmp/migrate.sql</pre>
                    <h3>
                        List locks on the database change log
                    </h3>
                    <pre>java -jar liquibase.jar \
        --driver=oracle.jdbc.OracleDriver \
        --classpath=jdbcdriver.jar \
        --url=jdbc:oracle:thin:@localhost:1521:oracle \
        --username=scott \
        --password=tiger \
        listLocks</pre>
                    <h3>
                        Runs LiquiBase using defaults from ./liquibase.properties
                    </h3>
                    <pre>java -jar liquibase.jar migrate</pre>
                    <pre>#liquibase.properties
driver: oracle.jdbc.OracleDriver
classpath: jdbcdriver.jar
url: jdbc:oracle:thin:@localhost:1521:oracle
username: scott
password: tiger</pre>
                </div>
            </div>
        </div>

    </body>
</html>