<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
    <head>
        <title>LiquiBase: Ant Task</title>
        <style type='text/css' media='screen'>@import "../../include/css/main.css";</style>
    </head>
    <body>@ANALYTICS@
        <img src="../../images/liquibase_logo.gif" alt="LiquiBase" class="topLogo"/>
        <p id="sitename">
            <strong>LiquiBase: Database Refactoring</strong>
        </p>

        <div id="container">
                @NAV.MANUAL@


            <div id="content">
                <div class="entry">
                    <h2>LiquiBase Ant Tasks</h2>
                    <p>
                        LiquiBase can be controlled via ant Tasks.  To use, simply add the liquibase.jar to your Ant lib directory or the classpath referenced by "classpathref".
                    </p>
                    <p>
                        Additional LiquiBase commands are supported by the <a href="command_line_migrator.html">command line migrator</a> that are not supported by the Ant tasks.
                    </p>
                    <h2>migrateDatabase Ant Task</h2>
<pre>

&lt;target name="migrate-database" depends="prepare"&gt;
    &lt;fail unless="db.changelog.file"&gt;db.changelog.file not set&lt;/fail&gt;
    &lt;fail unless="database.url"&gt;database.url not set&lt;/fail&gt;

    &lt;fail unless="database.username"&gt;database.username not set&lt;/fail&gt;
    &lt;fail unless="database.password"&gt;database.password not set&lt;/fail&gt;

    &lt;taskdef resource="migratortasks.properties"&gt;
        &lt;classpath refid="classpath"/&gt;

    &lt;/taskdef&gt;
    &lt;migrateDatabase
            changeLogFile="${db.changelog.file}"
            driver="${database.driver}"
            url="${database.url}"
            username="${database.username}"
            password="${database.password}"
            promptOnNonLocalDatabase="${prompt.user.if.not.local.database}"
            dropFirst="false"
            classpathref="classpath"
            &gt;
    &lt;/migrateDatabase&gt;
&lt;/target&gt;
</pre>
                <h3>
                    Available migrateDatabase Ant Parameters:
                </h3>
                <table class="attributesTable">
                    <tr><th>changeLogFile</th><td>The change log file to run</td></tr>
                    <tr><th>driver</th><td>The name of the database driver to connect with</td></tr>
                    <tr><th>url</th><td>The database URL</td></tr>
                    <tr><th>username</th><td>The database username to connect with</td></tr>
                    <tr><th>password</th><td>The password to use when connecting to the database</td></tr>
                    <tr><th>promptOnNonLocalDatabase</th><td>If set to true (default is false) a dialog box with warn you if you attempt to run the migrator against a database that is not on localhost</td></tr>
                    <tr><th>dropFirst</th><td>If set to true, LiquiBase will first drop all database objects owned by the connected user [defaults to FALSE]</td></tr>
                    <tr><th>classpathref</th><td>A reference to the classpath that contains the database driver, liquibase.jar, and the changelog.xml file</td></tr>
                    <tr><th>contexts</th><td>A comma separated list of <a href="contexts.html">contexts</a> to execute.  If not specified, all contexts are run.</td></tr>
                    <tr><th>currentDateTimeFunction</th><td>Overrides current date time function used in SQL.  Useful for unsupported databases</td></tr>
                </table>

<h2>rollbackDatabase Ant Task</h2>
<pre>

&lt;target name="rollback-database" depends="prepare"&gt;
    &lt;fail unless="db.changelog.file"&gt;db.changelog.files not set&lt;/fail&gt;
    &lt;fail unless="database.url"&gt;database.url not set&lt;/fail&gt;

    &lt;fail unless="database.username"&gt;database.username not set&lt;/fail&gt;
    &lt;fail unless="database.password"&gt;database.password not set&lt;/fail&gt;

    &lt;taskdef resource="migratortasks.properties"&gt;
        &lt;classpath refid="classpath"/&gt;

    &lt;/taskdef&gt;
    &lt;rollbackDatabase
            changeLogFile="${db.changelog.file}"
            driver="${database.driver}"
            url="${database.url}"
            username="${database.username}"
            password="${database.password}"
            classpathref="classpath"
            rollbackTag="release1.2"
            &gt;
    &lt;/migrateDatabase&gt;
&lt;/target&gt;
</pre>
                <h3>
                    Available rollbackDatabase Ant Parameters:
                </h3>
                <table class="attributesTable">
                    <tr><th>changeLogFile</th><td>The change log file to run</td></tr>
                    <tr><th>driver</th><td>The name of the database driver to connect with</td></tr>
                    <tr><th>url</th><td>The database URL</td></tr>
                    <tr><th>username</th><td>The database username to connect with</td></tr>
                    <tr><th>password</th><td>The password to use when connecting to the database</td></tr>
                    <tr><th>classpathref</th><td>A reference to the classpath that contains the database driver, liquibase.jar, and the changelog.xml files</td></tr>
                    <tr><th>contexts</th><td>A comma separated list of <a href="contexts.html">contexts</a> to execute.  If not specified, all contexts are run.</td></tr>
                    <tr><th>rollbackTag</th><td>Tag to roll back to</td></tr>
                    <tr><th>rollbackDate</th><td>Date to roll back to</td></tr>
                    <tr><th>rollbackCount</th><td>Number of changeSets to roll back</td></tr>
                </table>
            </div>
        </div>
       </div>
    </body>
</html>